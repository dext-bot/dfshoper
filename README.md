# DF Shopper 自动工具

该项目提供一个在 Windows 上运行的图形化工具，支持使用显卡加速的图像识别来辅助在游戏商城中自动寻找低价商品并执行购买或宏操作。

## 功能概述

- **GPU OCR**：基于 [easyocr](https://github.com/JaidedAI/EasyOCR)，自动启用 GPU 加速以快速识别商品价格。
- **坐标配置**：启动时读取 `config.json` 配置文件，包含交易行按钮、主界面选项、配置装备选项、购买按钮、最高购买数量按钮、两段价格识别区域等坐标。如果缺失，可通过应用内置的截图工具重新设置。
- **模式1：自动扫货**
  - 拖拽按钮到屏幕坐标即可记录位置。
  - 在 UI 中设置扫货最低价格和识别间隔。
  - 自动识别商品价格1、价格2 的数值，判断是否在期望阈值内并执行最大数量购买及确认购买操作。
- **模式2：价格监控与宏执行**
  - 通过截图选择价格识别区域、终止判定坐标及颜色。
  - 设置触发价格，当识别价格高于阈值执行宏操作1，反之执行宏操作2。
  - 宏操作2 执行完毕后会再次截图取色，根据用户指定的颜色判断是否终止循环。
- **宏录制**：支持录制两套键鼠操作序列，可在模式2中按需执行。

## 安装

1. 安装 Python 3.10+ 与 CUDA 驱动。
2. 安装所需依赖：

   ```bash
   pip install -r requirements.txt
   ```

3. Windows 需额外允许 `pyautogui`、`pynput` 在后台控制鼠标键盘。

## 使用步骤

1. 运行应用：

   ```bash
   python -m dfshoper.app
   ```

2. 如配置文件缺失，将在 3 秒后弹出截图窗口。依提示在 UI 中拖拽按钮或选择区域完成坐标设定，并保存配置。
3. 在模式1中设置扫货最低价格和识别间隔，点击“启动模式1”。
4. 在模式2中录制宏操作1/2，设置触发价格与终止颜色后点击“启动模式2”。

## 配置文件

`config.json` 会自动保存以下字段：

- `coordinates`：交易行、主界面、装备界面、购买按钮、最大数量按钮、两个价格区域等坐标。
- `mode_one`：扫货最低价格、识别间隔。
- `mode_two`：价格识别区域、触发价格、终止颜色与坐标。
- `recorder`：宏操作1/2的事件序列。

## 注意事项

- 请确保使用独立显卡并正确安装 CUDA，以便 easyocr 调用 GPU。
- 若 OCR 识别失败，可适当增大识别区域或调整光标位置。
- 应用在后台自动点击鼠标与键盘，请避免与其他窗口交互导致误操作。

## 许可证

本项目基于 MIT License 发布。
